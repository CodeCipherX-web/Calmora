<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Login to Calmora">
    <title>Login - Calmora</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    <!-- Google Fonts - Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Skip to main content link for accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo" style="display: flex; align-items: center; gap: 0.75rem;">
                <img src="favicon.svg" alt="Calmora Logo" style="width: 32px; height: 32px; flex-shrink: 0;">
                <span>Calmora</span>
            </a>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="signup.html">Sign Up</a></li>
            </ul>
            <div class="hamburger" aria-label="Toggle navigation menu">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
        <section class="section" style="padding: 3rem 0;">
            <div class="container">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; align-items: center; max-width: 1100px; margin: 0 auto;">
                    <!-- Image Section -->
                    <div class="login-image-section">
                        <div style="position: relative; padding: 2rem;">
                            <div style="position: absolute; top: -20px; right: -20px; width: 100%; height: 100%; background: linear-gradient(135deg, var(--primary-color), var(--accent-color)); border-radius: 24px; opacity: 0.15; z-index: 0; transform: rotate(3deg);"></div>
                            <div style="position: absolute; bottom: -15px; left: -15px; width: 100%; height: 100%; background: linear-gradient(135deg, var(--accent-color), var(--success-color)); border-radius: 24px; opacity: 0.1; z-index: 0; transform: rotate(-3deg);"></div>
                            <div class="auth-image-container" style="position: relative; z-index: 1; border-radius: 20px; overflow: hidden; box-shadow: var(--shadow-xl); border: 4px solid var(--primary-color);">
                                <img src="https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?w=600&h=700&fit=crop&q=80" alt="Welcome Back" class="auth-image active" style="width: 100%; height: auto; display: block; transition: opacity 1.5s ease-in-out;">
                                <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=600&h=700&fit=crop&q=80" alt="Mental Health Support" class="auth-image" style="width: 100%; height: auto; display: none; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 1.5s ease-in-out;">
                                <img src="https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=600&h=700&fit=crop&q=80" alt="Wellness Journey" class="auth-image" style="width: 100%; height: auto; display: none; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 1.5s ease-in-out;">
                                <img src="https://images.unsplash.com/photo-1506126613408-eca07ce68773?w=600&h=700&fit=crop&q=80" alt="Self Care" class="auth-image" style="width: 100%; height: auto; display: none; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 1.5s ease-in-out;">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Form Section -->
                    <div class="form-container">
                        <div class="card">
                            <div style="padding: 2rem;">
                                <h2 style="text-align: center; margin-bottom: 0.75rem; font-size: 2rem; font-weight: 700;">Login to Calmora</h2>
                                <p style="text-align: center; color: var(--text-medium); margin-bottom: 2rem;">Welcome back! Please login to continue.</p>

                <!-- Form Feedback -->
                <div id="formFeedback" class="form-feedback"></div>

                <!-- Login Form -->
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Username or Email</label>
                        <input 
                            type="text" 
                            id="username" 
                            name="username" 
                            class="form-control" 
                            placeholder="Enter your username or email"
                            required
                            autocomplete="username"
                            aria-describedby="username-error"
                        >
                        <span class="error-message" id="username-error" role="alert"></span>
                    </div>

                    <div class="form-group">
                        <label for="password">Password</label>
                        <input 
                            type="password" 
                            id="password" 
                            name="password" 
                            class="form-control" 
                            placeholder="Enter your password"
                            required
                            autocomplete="current-password"
                            aria-describedby="password-error"
                        >
                        <span class="error-message" id="password-error" role="alert"></span>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="rememberMe" name="rememberMe">
                        <label for="rememberMe">Remember me</label>
                    </div>

                    <div style="text-align: center; margin: 1rem 0;">
                        <a href="#" style="font-size: 0.875rem;">Forgot password?</a>
                    </div>

                    <button type="submit" class="btn" style="width: 100%;">
                        Login
                    </button>
                </form>

                            <p style="text-align: center; margin-top: 2rem; color: var(--text-medium);">
                                Don't have an account? <a href="signup.html" style="color: var(--primary-color); font-weight: 600;">Sign up here</a>
                            </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Calmora. All rights reserved.</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="helpers.js"></script>
    <script src="api.js"></script>
    <script src="auth.js"></script>
    <script src="main.js"></script>
    <script>
        // Image slideshow for login page
        (function() {
            'use strict';

            document.addEventListener('DOMContentLoaded', function() {
                const imageContainer = document.querySelector('.login-image-section .auth-image-container');
                if (imageContainer) {
                    const images = imageContainer.querySelectorAll('.auth-image');
                    let currentIndex = 0;
                    
                    function switchImage() {
                        // Hide current image
                        images[currentIndex].style.opacity = '0';
                        setTimeout(() => {
                            images[currentIndex].style.display = 'none';
                            
                            // Move to next image
                            currentIndex = (currentIndex + 1) % images.length;
                            
                            // Show next image
                            images[currentIndex].style.display = 'block';
                            setTimeout(() => {
                                images[currentIndex].style.opacity = '1';
                            }, 50);
                        }, 1500);
                    }
                    
                    // Switch image every 4 seconds
                    setInterval(switchImage, 4000);
                }
            });
        })();

        // Login form handler
        (function() {
            'use strict';

            document.addEventListener('DOMContentLoaded', function() {
                const loginForm = document.getElementById('loginForm');
                const formFeedback = document.getElementById('formFeedback');
                const submitButton = loginForm.querySelector('button[type="submit"]');

                // Redirect if already authenticated
                window.Auth.redirectIfAuthenticated();

                // Handle form submission
                window.Main.handleFormSubmit(loginForm, async function(form) {
                    const formData = new FormData(form);
                    const credentials = {
                        username: formData.get('username').trim(),
                        password: formData.get('password'),
                    };

                    // Show loading state
                    window.Helpers.showButtonLoading(submitButton);
                    window.Helpers.hideMessage(formFeedback);

                    try {
                        // Call login API
                        const result = await window.API.auth.login(credentials);
                        
                        // Handle success
                        window.Auth.handleAuthSuccess({ data: result });
                        
                        // Show success message
                        formFeedback.classList.add('success');
                        formFeedback.classList.remove('error');
                        formFeedback.textContent = 'Login successful! Redirecting...';
                        formFeedback.classList.add('show');

                        // Redirect to homepage
                        window.Helpers.redirect('index.html', 1000);
                    } catch (error) {
                        // Handle error
                        window.Auth.handleAuthError(error, formFeedback);
                    } finally {
                        // Hide loading state
                        window.Helpers.hideButtonLoading(submitButton);
                    }
                });
            });
        })();
    </script>
</body>
</html>

